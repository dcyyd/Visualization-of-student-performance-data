<h1 align="center">学生成绩数据可视化展示程序分析</h1>

## 一、变量含义

### （一）全局变量

1. `_src_folder`
   定义了数据源文件夹的路径，初始值为 `'data_source'`，程序会从该文件夹下查找如 `StudentsPerformance.csv`
   这类学生成绩数据文件以及可能存在的补充数据文件，用于统一管理数据读取位置。
2. `_dst_folder`
   代表备份文件夹的路径，初始值为 `'data_backup'`
   ，主要用于存放备份的原始数据集以及程序运行过程中产生的相关文件，确保原始数据有副本保存，方便后续回溯或验证处理过程的准确性。不过这种全局变量的使用方式从代码规范性角度不太推荐，更好的做法是通过函数参数传递路径信息，但此处为演示方便暂做此设置。

### （二）函数参数相关变量

1. `file_path`
   作为函数参数，是一个字符串类型变量，用于精确指定要处理的学生成绩数据文件的具体位置。在程序中通过 `os.path.join(_src_folder, 'StudentsPerformance.csv')`
   构建完整路径，使得相应函数能准确读取对应CSV格式的数据文件，在多个函数间传递数据读取的关键路径信息。
2. `output_dir`
   同样作为函数参数，指向一个输出文件夹的路径，字符串类型，用于存放程序运行过程中生成的各类结果文件，像预处理后的数据文件、数据分析结果文件以及可视化生成的HTML文件等，保证所有输出内容有统一存放位置，便于后续管理和查找，符合模块化编程中对输入输出路径管理的要求。

## 二、知识点

### （一）数据处理与分析基础

1. **数据预处理**
    - **数据备份**：在处理原始数据前先备份是良好的数据管理习惯，通过 `os.makedirs` 确保备份文件夹存在后，利用 `data.to_csv`
      将读取的原始数据保存到指定备份文件路径中，防止后续误操作丢失原始数据，方便回溯验证数据处理情况。
    - **列名汉化**：将数据列名替换为中文，增强了数据的可读性与可理解性，方便后续查看、分析及可视化展示时直观知晓各列代表的含义，符合本地化及方便用户理解数据的原则。
    - **缺失值处理**：针对不同列特点采用不同缺失值处理方式，成绩列（如 `数学成绩`、`阅读成绩`、`写作成绩`
      ）用中位数填充，因中位数对极端值不敏感，可保持数据集中趋势；`午餐`
      列用众数填充，符合分类数据特征，用出现次数最多的值补充缺失项；`备考课程` 列依据与 `父母教育水平`
      的映射关系填充，基于业务逻辑关联推测缺失值，使数据更完整合理。
    - **数据合并**：使用 `pd.merge` 函数按 `'学生编号'` 进行左连接合并数据，可整合补充数据（若存在 `supplementary_data.csv`
      文件）到主学生成绩数据中，丰富数据集维度，便于更全面分析学生成绩相关因素，是实际数据整合场景常用操作。
    - **数据清洗（去重）**：调用 `data.drop_duplicates` 去除重复行，保证数据唯一性，避免重复数据干扰后续统计分析、可视化等操作，提升数据质量，让基于该数据的分析和可视化结果更可靠准确。
2. **数据分析**
   运用分组分析思想，在 `analyze_data` 函数里基于不同维度（如 `种族/民族`、`性别`、`父母教育水平`、`午餐`、`备考课程`
   ）对数据分组，通过 `groupby` 操作分类后，分别计算各分组下成绩列（如 `数学成绩`、`阅读成绩`、`写作成绩`
   ）的平均值和标准差，以此探究不同因素对学生成绩分布的影响，如了解不同群体成绩的集中趋势和离散程度差异，挖掘数据背后规律与关系。

### （二）数据可视化

1. **常用图表解读与应用场景**
    - **箱型图**
      ：如按不同因素（种族、性别等）与数学成绩绘制的箱型图，能展示数据的中位数、上下四分位数及异常值等关键统计信息。对比不同箱型的位置、长度等特点，可直观分析不同因素对成绩分布的影响，判断成绩集中区域、波动范围及极端情况等，为探究成绩差异原因提供可视化依据。
    - **饼图**：通过对成绩数据分箱处理绘制平均成绩等级分布饼图，展示各成绩等级（如不及格、及格等）所占比例，清晰直观呈现整体成绩优劣分布情况，便于快速从宏观角度把握整体成绩水平，了解成绩集中的等级范围。
    - **直方图**：利用 `sns.histplot` 绘制的数学成绩分布直方图，呈现成绩数据在各区间的频数分布，观察其形态、峰值位置、不同区间频数变化等特征，可深入了解成绩具体分布特点，辅助分析分布规律及特殊模式。

## 三、方法使用

### （一）`os` 模块相关方法

1. `os.makedirs`
   用于创建多层级的文件夹目录，在代码多处创建不同功能对应的文件夹（如备份文件夹、数据分析结果文件夹、可视化结果文件夹等）时被调用，设置 `exist_ok=True`
   参数确保即使文件夹已存在也不会报错，增强程序健壮性，避免因文件夹创建问题导致程序中断，保障跨平台运行兼容性。
2. `os.path.join`
   将多个路径片段组合成完整路径字符串，遵循不同操作系统的路径分隔符规范。广泛用于拼接数据源文件夹与文件名、输出文件夹与子文件夹名以及构建各种文件的具体保存路径，使路径拼接操作更灵活且避免手动写死分隔符带来的兼容性问题。

### （二）`pandas` 库相关方法

1. `read_csv`
   用于读取CSV格式的数据文件并转换为 `DataFrame` 数据结构，是 `pandas` 常用的数据读取方法，在 `preprocess_data`
   函数起始处通过它读入学生成绩数据文件，后续所有操作基于此 `DataFrame` 展开，且支持多种参数设置应对不同格式CSV文件特点。
2. `to_csv`
   与 `read_csv` 相反，将 `DataFrame`
   格式的数据保存为CSV文件，在备份原始数据、保存预处理后的数据及其他需输出数据到文件场景中使用，通过设置参数（如控制索引保存、指定编码格式等）按需求准确输出数据，便于数据持久化存储、查看和共享。
3. `groupby`
   强大的分组操作方法，在 `analyze_data` 函数里按指定列的值对数据分组，生成 `GroupBy` 对象后配合聚合函数（如 `mean`、`std`
   等）对各分组内数据计算，以此分析不同分组下的数据特征，是数据分析中按类别或特征归类分析的重要手段。
4. `fillna`
   用于填充数据中的缺失值，在 `preprocess_data` 函数中针对不同列采用不同逻辑填充缺失值时使用，可灵活选择合适填充值（中位数、众数或通过映射关系得到的值等）补充缺失部分，使数据完整以便后续分析。
5. `drop_duplicates`
   实现去除数据中重复行功能，在数据清洗阶段调用，保证数据唯一性，提升数据质量，避免重复数据对后续分析和可视化造成误导。
6. `info`
   获取 `DataFrame` 的基本信息（列名、数据类型、非空值数量等），在 `preprocess_data` 函数中用于将数据基本信息保存到文件，方便查看了解数据集概况。
7. `head`
   返回 `DataFrame` 的前几行数据，在 `preprocess_data`
   函数里根据数据集行数和列数情况，选择将全部数据或前几行数据内容信息保存到文件，便于快速查看数据大致样子，默认返回前5行数据，可通过参数指定返回行数。
8. `merge`
   实现数据合并操作，按指定连接键（如 `'学生编号'`）和连接方式（如 `how='left'`）将两个 `DataFrame`
   合并，常用于整合来自不同数据源但有关联字段的数据，丰富数据集信息维度。
9. `cut`
   在绘制饼图时用于对成绩数据进行区间划分，依据设定区间边界将连续成绩数值划分到不同等级类别（通过 `labels`
   参数指定等级标签），进而统计各等级数量展示成绩等级分布情况，是数据分箱处理常用方法。

### （三）`matplotlib` 和 `seaborn` 相关绘图方法

1. `matplotlib` 中的 `plt.figure`
   用于创建新的图形对象并设定其大小等属性（通过 `figsize`
   参数指定宽高尺寸），是绘制各种可视化图表的前置操作，后续绘图元素（坐标轴、图形、标题等）添加到该图形对象上，作为绘图的基础框架。
2. `sns.boxplot`、`sns.histplot` 等（`seaborn` 库方法）
   `seaborn` 基于 `matplotlib` 提供更美观便捷的绘图函数，`sns.boxplot` 可快速绘制箱型图，只需指定 `x`、`y`
   轴对应的列名及数据源就能生成展示数据分布特征的箱型图；`sns.histplot`
   用于绘制直方图，传入要绘制的列数据及相关参数（如 `bins` 设定箱数、`kde` 控制是否显示核密度估计曲线）即可呈现数据分布形态，方便快捷生成高质量可视化图表。
3. `plt.title`、`plt.xticks`、`plt.xlabel`、`plt.ylabel` 等（`matplotlib` 库方法）
   这些方法用于设置图形的标题、坐标轴刻度标签、坐标轴名称等元素，进一步完善可视化图表细节，使其更清晰易读，准确传达数据信息和分析意图，辅助理解图表所展示的数据特征与规律。
4. `mpld3.fig_to_html`
   来自 `mpld3` 库，功能是将 `matplotlib`
   绘制的图形对象转换为HTML格式，契合本程序将可视化结果保存为HTML文档以便后续查看分析的需求，实现可视化结果从Python绘图环境到网页可展示形式的转换，拓展了可视化成果展示途径和应用场景。
5. `plt.show`
   用于显示绘制好的图形，在代码可视化部分每次绘制完一个图表后调用可即时查看图形效果，不过在实际生成最终结果用于保存的场景中，主要用于调试绘图代码时直观验证图形是否符合预期，非必需操作。
6. `plt.pie`
   用于绘制饼图，传入要展示的数据（如各等级成绩数量）、对应标签及其他参数（如控制百分比显示格式、设定起始角度、指定扇形颜色等），就能生成直观展示各部分占比关系的饼图。

## 四、函数功能

### （一）`preprocess_data` 函数

1. **功能概述**
   对给定路径的学生成绩数据文件进行多方面预处理操作，包括备份原始数据集、汉化列名、处理缺失值、数据合并以及去除重复行等，最后返回经过预处理后的学生成绩数据（以 `DataFrame`
   格式），为后续数据分析和可视化提供干净、规范的数据基础。
2. **参数和返回值**
   参数 `file_path` 指定要处理的数据文件路径，`output_dir`
   定义输出文件夹路径用于存放处理相关文件；返回值为预处理后的学生成绩数据 `DataFrame`，供后续分析和可视化函数使用。

### （二）`analyze_data` 函数

1. **功能概述**
   对预处理后的学生成绩数据进行深入分析，按不同维度（如种族、性别等）分组计算平均成绩以及成绩的标准差，并将这些分析结果保存到对应的文件中，帮助全面了解数据在不同影响因素下的分布情况，挖掘数据蕴含的信息规律。
2. **参数和返回值**
   参数 `data` 接收 `preprocess_data` 函数返回的预处理后的数据 `DataFrame`，`output_dir`
   指定分析结果文件的输出文件夹路径；函数无返回值，而是将计算结果保存到文件中方便查看分析。

### （三）`visualize_data` 函数

1. **功能概述**
   负责对学生成绩数据进行多种可视化展示，包括箱型图、饼图、直方图等，将生成的可视化图表转换为HTML文档保存到指定输出文件夹中，同时针对每种可视化结果给出简单分析论述，便于更好理解和解读可视化呈现的数据特征与规律。
2. **参数和返回值**
   参数 `data` 基于 `preprocess_data` 函数返回的预处理后的数据 `DataFrame`，`output_dir`
   为可视化相关HTML文件的输出文件夹路径；函数无返回值，重点在于保存可视化图表并附带分析说明，完成数据直观展示环节。

### （四）`main` 函数

1. **功能概述**
   作为程序的主函数和入口点，协调各个功能模块的调用顺序，先创建输出文件夹（若不存在），再构建数据文件完整路径，然后依次调用 `preprocess_data`、`analyze_data`
   和 `visualize_data` 函数，按顺序完成数据处理、分析和可视化的整体流程，将整个程序各环节串联起来，保障程序完整运行并输出最终结果和可视化展示文件。
2. **参数和返回值**
   该函数无参数输入也无返回值，主要起到组织调度其他函数执行相应操作的作用。

## 五、库的作用

### （一）`pandas`

是Python中用于数据处理和分析的核心库，提供高效的数据结构（如 `DataFrame` 和 `Series`
）以及丰富的数据操作方法（数据读取、清洗、转换、分组计算等），在本程序各环节（从读取原始数据、预处理到数据分析分组操作等）都发挥基础支撑作用，是整个数据处理流程不可或缺的工具库。

### （二）`matplotlib` 和 `seaborn`

`matplotlib` 是Python常用基础绘图库，提供丰富绘图函数和底层图形元素控制方法，可绘制各类图表，但原生绘图样式较基础；`seaborn`
基于 `matplotlib` 提供更美观便捷绘图接口及高级统计可视化功能，二者配合使用，先利用 `seaborn`
快速生成图表，再用 `matplotlib` 调整图表细节元素，生成高质量可视化图表用于展示和分析学生成绩数据。

### （三）`mpld3`

主要用于将 `matplotlib` 绘制的图形转换为HTML格式，使生成的可视化图表可方便在网页端展示和分享，满足本程序将可视化结果保存为HTML文档以便后续查看分析的需求，拓展了可视化成果展示途径和应用场景。

## 六、程序执行过程

1. **程序入口**：从 `main` 函数开始执行，作为整个程序的入口点，它负责协调各功能模块按顺序调用，先进行一些初始化的准备工作。
2. **创建输出文件夹**：在 `main` 函数中，首先判断 `output` 文件夹是否存在，若不存在则通过 `os.makedirs`
   创建该文件夹，用于存放后续程序运行产生的各类结果文件。
3. **构建数据文件路径**：接着利用 `os.path.join` 方法将 `_src_folder` （数据源文件夹路径）与 `StudentsPerformance.csv`
   拼接成完整的 `file_path`，确定要读取的学生成绩数据文件位置。
4. **数据预处理**：调用 `preprocess_data` 函数，传入 `file_path` 和 `output_dir` 参数，在函数内部按顺序执行以下操作：
    - 设置 `matplotlib` 的字体和负号显示相关参数，方便后续可视化中文显示及正确处理负号情况。
    - 通过 `pd.read_csv` 读取指定路径的数据文件为 `DataFrame` 格式的数据。
    - 备份原始数据集到 `_dst_folder` 下的指定文件。
    - 将列名汉化，提升数据可读性。
    - 创建预处理数据对应的文件夹，并根据数据集大小将数据基本信息或部分数据内容信息保存到文件中。
    - 按不同策略处理各列的缺失值，使数据完整。
    - 若存在补充数据文件，进行数据合并操作。
    - 去除数据中的重复行，清洗数据。
    - 最后将预处理后的数据保存到预处理数据文件夹下指定文件，并返回预处理后的数据 `DataFrame`。
5. **数据分析**：将 `preprocess_data` 函数返回的数据 `DataFrame` 作为参数传入 `analyze_data` 函数，同时传入 `output_dir`
   参数，在该函数内部：
    - 先创建用于存放数据分析结果的文件夹。
    - 遍历设定的不同维度（如 `种族/民族` 等），针对每个维度通过 `groupby` 方法对数据分组，然后分别计算成绩列（如 `数学成绩`
      等）的平均成绩和标准差。
    - 将每个维度下的平均成绩和标准差结果分别保存到对应的文本文件中，文件名根据维度进行特殊处理（替换路径不合法字符），方便后续查看分析不同维度下的成绩分布情况。
6. **数据可视化**：再将 `preprocess_data` 函数返回的数据 `DataFrame` 传入 `visualize_data` 函数，以及传入 `output_dir`
   参数，在函数内执行以下操作：
    - 创建可视化结果对应的文件夹。
    - 依次绘制不同类型的可视化图表（箱型图、饼图、直方图等），对于每个图表：
        - 通过相应的 `matplotlib` 和 `seaborn` 绘图函数创建图形对象、设置图形标题、坐标轴等元素，绘制出符合需求的图表。
        - 针对每个图表给出相应的分析论述，解释从该图表中可以观察到的数据特征和规律。
        - 利用 `mpld3.fig_to_html` 方法将绘制好的图形对象转换为HTML格式，并保存到可视化结果文件夹下对应的HTML文件中，方便后续在网页端查看可视化展示效果。
7. **程序结束**：完成上述数据处理、分析和可视化流程后，程序正常结束，最终在 `output`
   文件夹及其相应子文件夹下生成备份数据文件、数据分析结果文件以及可视化展示的HTML文件等各类结果文件，实现对学生成绩数据从原始数据到分析可视化展示的完整处理流程。 